#!/bin/nvim -S

let s:scheme = trim(execute("colorscheme"), "\000")

"The new vim default colorscheme messes up colors probably with TOhtml
colorscheme vim
execute 'colorscheme ' . s:scheme

let s:file = argv(0)
if s:file == ""
    echoerr "No file given"
    exit
endif

let s:colorscheme = argv(1)
if s:colorscheme != ""
    execute 'color ' . s:colorscheme
endif

execute 'edit ' . s:file

let s:presnapshot = argv(2)
if s:presnapshot != ""
    execute s:presnapshot
else
    "unfold all folds
    norm zR
endif

TOhtml /tmp/nvim-file.html
"special profile because librewolf hangs when using in-use profiles
!librewolf -P nvim-screenshot --screenshot file:///tmp/nvim-file.html
qall!
